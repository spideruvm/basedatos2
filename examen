CREATE TABLE PRODUCTO (
ID_PRODUCTO INTEGER,
NOMBRE VARCHAR2(120),
PRECIO FLOAT,
CONSTRAINT ID_PRODUCTO_PK PRIMARY KEY(ID_PRODUCTO));

CREATE TABLE COMPRADOR (
ID_COMPRADOR INTEGER,
ID_PRODUCTO INTEGER,
NOMBRE VARCHAR2(120),
TELEFONO VARCHAR2(12),
NUMERO_TARJETA INTEGER,
CONSTRAINT ID_COMPRADOR_PK PRIMARY KEY(ID_COMPRADOR),
CONSTRAINT ID_PRODUCTO_FK FOREIGN KEY(ID_PRODUCTO)
REFERENCES PRODUCTO(ID_PRODUCTO));

create sequence SEC_PRODUCTO
start with 1
increment by 1
nomaxvalue;

create sequence SEC_COMPRADOR
start with 1
increment by 1
nomaxvalue;

create or replace PROCEDURE GUARDAR_PRODUCTO(
MY_ID_PRODUCTO OUT INTEGER,
MY_NOMBRE IN VARCHAR2,
MY_PRECIO IN FLOAT)AS
BEGIN 
SELECT SEC_PRODUCTO.NEXTVAL INTO MY_ID_PRODUCTO FROM DUAL;
INSERT INTO PRODUCTO VALUES(
MY_ID_PRODUCTO,
MY_NOMBRE,
MY_PRECIO);
END;
/
create or replace PROCEDURE GUARDAR_COMPRADOR(
MY_ID_COMPRADOR OUT INTEGER,
MY_ID_PRODUCTO IN INTEGER,
MY_NOMBRE IN VARCHAR2,
MY_TELEFONO IN VARCHAR2,
MY_NUMERO_TARJETA IN INTEGER)AS
BEGIN 
SELECT SEC_COMPRADOR.NEXTVAL INTO MY_ID_COMPRADOR FROM DUAL;
INSERT INTO COMPRADOR VALUES(
MY_ID_COMPRADOR, 
MY_ID_PRODUCTO,
MY_NOMBRE,
MY_TELEFONO,
MY_NUMERO_TARJETA);
END;
/
declare
algo integer;
BEGIN
GUARDAR_PRODUCTO (algo,'CEREAL',20);
GUARDAR_PRODUCTO (algo,'PASTA',21);
GUARDAR_PRODUCTO (algo,'LECHE',22);
GUARDAR_PRODUCTO (algo,'PAPEL',23);
end;
/
SELECT * FROM PRODUCTO;
DECLARE 
ALGO INTEGER;
BEGIN

GUARDAR_COMPRADOR(ALGO,24,'ANDRES',55214499,13131313);
GUARDAR_COMPRADOR(ALGO,24,'FERNANDA',55214489,2121212);
END;
/
SELECT * FROM COMPRADOR;
SET SERVEROUTPUT ON;
DECLARE
CURSOR CURSOR_RESUMEN IS SELECT COMP.NOMBRE, COMP.TELEFONO, PRO.PRECIO, PRO.NOMBRE AS PRO_NOMBRE,COMP.ID_COMPRADOR
FROM PRODUCTO PRO, COMPRADOR COMP
WHERE COMP.ID_PRODUCTO=PRO.ID_PRODUCTO ORDER BY COMP.NOMBRE;
BEGIN
FOR REGISTRO IN CURSOR_RESUMEN LOOP
DBMS_OUTPUT.PUT_LINE('NOMBRE DEL CLIENTE: '||REGISTRO.NOMBRE||'  TELEFONO: '||REGISTRO.TELEFONO||' PRODUCTO: '||REGISTRO.PRO_NOMBRE||' PRECIO:'||REGISTRO.PRECIO);
END LOOP;
END;
/
